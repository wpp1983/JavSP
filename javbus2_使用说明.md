# JavBus2 增强爬虫使用说明

## 概述

JavBus2是一个增强版的JavBus爬虫，专门解决原版javbus爬虫遇到的SSL连接问题。它提供了更强的网络稳定性和错误恢复能力。

## 主要特性

### 🔧 SSL错误处理增强
- 自定义SSL上下文配置
- 支持多种TLS协议版本 (TLSv1.2/TLSv1.3)
- 智能SSL错误恢复机制

### 🔄 智能重试机制
- 指数退避重试策略
- 针对不同错误类型的差异化处理
- 404错误快速识别，避免无效重试

### 🛡️ 反爬虫策略
- 多User-Agent轮换
- 随机请求间隔
- 智能请求头设置

### 📊 增强的网络处理
- 连接池优化
- 请求超时管理
- 代理服务器支持

## 配置方法

在 `config.yml` 文件中的 `crawler` -> `selection` 部分进行配置：

### 方法1: 替换原javbus爬虫
```yaml
crawler:
  selection:
    normal: [javbus2, javdb]
```

### 方法2: 与原javbus并行使用
```yaml
crawler:
  selection:
    normal: [javbus, javbus2, javdb]
```

### 方法3: 优先使用javbus2
```yaml
crawler:
  selection:
    normal: [javbus2, javbus, javdb]
```

## 兼容性

- ✅ 完全兼容现有JavSP配置
- ✅ 支持所有现有网络配置（代理、超时等）
- ✅ 数据格式与原javbus爬虫完全一致
- ✅ 支持现有的genre映射和数据清洗流程

## 测试结果

经过测试，javbus2爬虫能够成功抓取以下数据：

- ✅ 影片标题
- ✅ 封面图片
- ✅ 预览图片
- ✅ 演员信息及头像
- ✅ 类别标签
- ✅ 发布日期
- ✅ 其他影片元数据

## 性能优化

### 网络连接优化
- 使用连接池减少连接开销
- 支持HTTP/HTTPS自适应
- 智能超时管理

### 错误处理优化
- SSL连接失败自动重试
- 网络不稳定时的指数退避
- 详细的调试日志输出

## 使用建议

1. **初次使用**: 建议先设置为 `normal: [javbus2, javdb]` 进行测试
2. **网络不稳定**: 在网络条件不佳时，javbus2比原版更稳定
3. **SSL问题**: 如果遇到SSL相关错误，建议优先使用javbus2
4. **调试模式**: 可以通过日志级别设置来查看详细的网络请求信息

## 故障排除

如果遇到问题，请检查：

1. 网络连接是否正常
2. 代理设置是否正确
3. config.yml中的配置是否有语法错误
4. 查看日志输出中的详细错误信息

## 技术实现

javbus2采用以下技术：

- **SSL上下文管理**: 自定义SSL配置以处理各种SSL问题
- **会话管理**: 使用requests.Session进行连接复用
- **重试策略**: urllib3.Retry配置自动重试机制
- **错误分类**: 针对不同类型错误采用不同处理策略

## 更新日志

- **v1.0.0** (2025-08-04): 初始版本发布
  - 实现增强的SSL错误处理
  - 添加智能重试机制
  - 集成反爬虫策略
  - 完成JavSP系统集成

---

如有问题或建议，请提交issue或联系开发者。